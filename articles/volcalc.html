<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to volcalc • volcalc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to volcalc">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">volcalc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/volcalc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/kegg.html">Downloading from KEGG</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Meredith-Lab/volcalc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to volcalc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Meredith-Lab/volcalc/blob/master/vignettes/volcalc.Rmd" class="external-link"><code>vignettes/volcalc.Rmd</code></a></small>
      <div class="d-none name"><code>volcalc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://meredith-lab.github.io/volcalc/">volcalc</a></span><span class="op">)</span></span></code></pre></div>
<p>The primary function in <code>volcalc</code> is
<code><a href="../reference/calc_vol.html">calc_vol()</a></code>. It accepts either a path to a .mol file or a
SMILES string. There are a few example .mol files included in the
<code>volcalc</code> installation and their file paths are returned by
<code><a href="../reference/mol_example.html">mol_example()</a></code>.</p>
<div class="section level3">
<h3 id="basic-usage-with--mol-files">Basic usage with .mol files<a class="anchor" aria-label="anchor" href="#basic-usage-with--mol-files"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#using built-in example .mol files</span></span>
<span><span class="va">mol_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mol_example.html">mol_example</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mol_paths</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/volcalc/extdata/C00031.mol"</span></span>
<span><span class="co">#&gt; [2] "/home/runner/work/_temp/Library/volcalc/extdata/C00157.mol"</span></span>
<span><span class="co">#&gt; [3] "/home/runner/work/_temp/Library/volcalc/extdata/C08491.mol"</span></span>
<span><span class="co">#&gt; [4] "/home/runner/work/_temp/Library/volcalc/extdata/C16181.mol"</span></span>
<span><span class="co">#&gt; [5] "/home/runner/work/_temp/Library/volcalc/extdata/C16286.mol"</span></span>
<span><span class="co">#&gt; [6] "/home/runner/work/_temp/Library/volcalc/extdata/C16521.mol"</span></span></code></pre></div>
<p>The default output of <code><a href="../reference/calc_vol.html">calc_vol()</a></code> includes a relative
volatility index, <code>rvi</code> which is equivalent to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">log</mtext><mn>10</mn></msub><msup><mi>C</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">\textrm{log}_{10}C^\ast</annotation></semantics></math>
(Meredith et al., 2023). It also includes a RVI category for clean
air.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">mol_paths</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in FUN(X[[i]], ...): Possible OpenBabel errors detected and only NAs returned.</span></span>
<span><span class="co">#&gt; Run with `validate = FALSE` to ignore this.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   mol_path                                          formula name    rvi category</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> /home/runner/work/_temp/Library/volcalc/extdata/… C6H12O6 D-Gl… -<span style="color: #BB0000;">2.81</span> non-vol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> /home/runner/work/_temp/Library/volcalc/extdata/… <span style="color: #BB0000;">NA</span>      Phos… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> /home/runner/work/_temp/Library/volcalc/extdata/… C12H18… (-)-…  1.85 moderate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> /home/runner/work/_temp/Library/volcalc/extdata/… C6H7Cl… beta…  6.98 high    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> /home/runner/work/_temp/Library/volcalc/extdata/… C12H22O Geos…  4.17 high    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> /home/runner/work/_temp/Library/volcalc/extdata/… C5H8    Isop…  8.85 high</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specify-environment">Specify environment<a class="anchor" aria-label="anchor" href="#specify-environment"></a>
</h3>
<p>Specifying <code>environment</code> only alters the RVI category by
using different RVI cutoffs for non-volatile, low, moderate, and high
volatility. Environment options and their category cutoffs are in the
<code><a href="../reference/calc_vol.html">calc_vol()</a></code> documentation and are discussed in more detail
in Meredith et al. (2023) and Donahue et al. (2006).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">mol_paths</span>, environment <span class="op">=</span> <span class="st">"soil"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in FUN(X[[i]], ...): Possible OpenBabel errors detected and only NAs returned.</span></span>
<span><span class="co">#&gt; Run with `validate = FALSE` to ignore this.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   mol_path                                          formula name    rvi category</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> /home/runner/work/_temp/Library/volcalc/extdata/… C6H12O6 D-Gl… -<span style="color: #BB0000;">2.81</span> non-vol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> /home/runner/work/_temp/Library/volcalc/extdata/… <span style="color: #BB0000;">NA</span>      Phos… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> /home/runner/work/_temp/Library/volcalc/extdata/… C12H18… (-)-…  1.85 non-vol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> /home/runner/work/_temp/Library/volcalc/extdata/… C6H7Cl… beta…  6.98 moderate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> /home/runner/work/_temp/Library/volcalc/extdata/… C12H22O Geos…  4.17 low     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> /home/runner/work/_temp/Library/volcalc/extdata/… C5H8    Isop…  8.85 high</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="return-intermediate-steps">Return intermediate steps<a class="anchor" aria-label="anchor" href="#return-intermediate-steps"></a>
</h3>
<p><code><a href="../reference/calc_vol.html">calc_vol()</a></code> uses a modified version of the SIMPOL.1
method by default which is a group contribution method. You can have
<code><a href="../reference/calc_vol.html">calc_vol()</a></code> return the counts of functional groups and other
molecular properties (which is useful for validation) with
<code>return_fx_groups = TRUE</code>. See <code>?get_fx_groups()</code>
for more information about these additional columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">mol_paths</span>, return_fx_groups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in FUN(X[[i]], ...): Possible OpenBabel errors detected and only NAs returned.</span></span>
<span><span class="co">#&gt; Run with `validate = FALSE` to ignore this.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 53</span></span></span>
<span><span class="co">#&gt;   mol_path           formula name    rvi category exact_mass carbons carbons_asa</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> /home/runner/work… C6H12O6 D-Gl… -<span style="color: #BB0000;">2.81</span> non-vol…      180.        6           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> /home/runner/work… <span style="color: #BB0000;">NA</span>      Phos… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>         0           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> /home/runner/work… C12H18… (-)-…  1.85 moderate      210.       12           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> /home/runner/work… C6H7Cl… beta…  6.98 high          270.        6           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> /home/runner/work… C12H22O Geos…  4.17 high          182.       12           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> /home/runner/work… C5H8    Isop…  8.85 high           68.1       5           0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 45 more variables: rings_aromatic &lt;int&gt;, rings_total &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   rings_aliphatic &lt;int&gt;, carbon_dbl_bonds_aliphatic &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   CCCO_aliphatic_ring &lt;int&gt;, hydroxyl_total &lt;int&gt;, hydroxyl_aromatic &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hydroxyl_aliphatic &lt;int&gt;, aldehydes &lt;int&gt;, ketones &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   carbox_acids &lt;int&gt;, ester &lt;int&gt;, ether_total &lt;int&gt;, ether_alkyl &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ether_alicyclic &lt;int&gt;, ether_aromatic &lt;int&gt;, nitrate &lt;int&gt;, nitro &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   amine_primary &lt;int&gt;, amine_secondary &lt;int&gt;, amine_tertiary &lt;int&gt;, …</span></span></span></code></pre></div>
<p>The SIMPOL.1 method calculates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">log</mtext><mn>10</mn></msub><msubsup><mi>P</mi><mrow><mtext mathvariant="normal">L</mtext><mo>,</mo><mi>i</mi></mrow><mo>∘</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{log}_{10} P_{\textrm{L},i}^\circ(T)</annotation></semantics></math>,
which is used by <code><a href="../reference/calc_vol.html">calc_vol()</a></code> to calculate RVI as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">log</mtext><mn>10</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mi>M</mi><mi>/</mi><mi>R</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{log}_{10}(PM/RT)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is the estimated vapor pressure for the compound,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is molecular weight of the compound,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is the universal gas constant, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is temperature (293.14K or 20ºC). To see these intermediate
calculations, use <code>return_calc_steps = TRUE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">mol_paths</span>, return_calc_steps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in FUN(X[[i]], ...): Possible OpenBabel errors detected and only NAs returned.</span></span>
<span><span class="co">#&gt; Run with `validate = FALSE` to ignore this.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   mol_path       formula name    rvi category molecular_weight log_alpha log10_P</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> /home/runner/… C6H12O6 D-Gl… -<span style="color: #BB0000;">2.81</span> non-vol…            180.       9.87 -<span style="color: #BB0000;">12.7</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> /home/runner/… <span style="color: #BB0000;">NA</span>      Phos… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                   <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>      1.79 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> /home/runner/… C12H18… (-)-…  1.85 moderate            210.       9.94  -<span style="color: #BB0000;">8.09</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> /home/runner/… C6H7Cl… beta…  6.98 high                272.      10.1   -<span style="color: #BB0000;">3.08</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> /home/runner/… C12H22O Geos…  4.17 high                182.       9.88  -<span style="color: #BB0000;">5.71</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> /home/runner/… C5H8    Isop…  8.85 high                 68.1      9.45  -<span style="color: #BB0000;">0.606</span></span></span></code></pre></div>
<p><code>log_alpha</code> =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">log</mtext><mn>10</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mi>/</mi><mi>R</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\textrm{log}_{10}(M/RT)</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="use-with-smiles">Use with SMILES<a class="anchor" aria-label="anchor" href="#use-with-smiles"></a>
</h3>
<p>All of this can be done using <a href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system" class="external-link">SMILES</a>
strings rather than .mol files with <code>from = "smiles"</code>.
Backslash, <code>\</code> is a valid SMILES character, but isn’t a valid
character in R and must be “escaped” as <code>\\</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This will error even though the SMILES is correct</span></span>
<span><span class="co"># calc_vol("CC/C=C\C[C@@H]1[C@H](CCC1=O)CC(=O)O", from = "smiles")</span></span>
<span></span>
<span><span class="co"># To solve this, escape \C as \\C</span></span>
<span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="st">"CC/C=C\\C[C@@H]1[C@H](CCC1=O)CC(=O)O"</span>, from <span class="op">=</span> <span class="st">"smiles"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   smiles                                 formula  name    rvi category</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>CC/C=C\\C[C@@H]1[C@H](CCC1=O)CC(=O)O<span style="color: #949494;">"</span> C12H18O3 <span style="color: #BB0000;">NA</span>     1.85 moderate</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h3>
<p>Occasionally, a .mol file will result in an error message bubbling up
from the OpenBabel command line utility. For example, if there is an ‘R’
group somewhere in the molecule as is the case with Phosphatidylcholine
on KEGG.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># phosphatidylcholine .mol file from KEGG</span></span>
<span><span class="va">c00157</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mol_example.html">mol_example</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<!-- the following chunks are not interactive because the OpenBabel errors also aren't captured when the vignette is built, so these must be edited manually to reflect what users actually see in their R console -->
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">c00157</span><span class="op">)</span></span>
<span><span class="co">#&gt; ==============================</span></span>
<span><span class="co">#&gt; *** Open Babel Warning  in InChI code</span></span>
<span><span class="co">#&gt;   Phosphatidylcholine :Unknown element(s): *</span></span>
<span><span class="co">#&gt; ==============================</span></span>
<span><span class="co">#&gt; *** Open Babel Error  in InChI code</span></span>
<span><span class="co">#&gt;   InChI generation failed</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span><span class="co">#&gt;   mol_path                                                          formula name                  rvi category</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                             &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt; &lt;fct&gt;   </span></span>
<span><span class="co">#&gt; 1 /Users/ericscott/Documents/GitHub/volcalc/inst/extdata/C00157.mol NA      Phosphatidylcholine    NA NA      </span></span>
<span><span class="co">#&gt; Warning message:</span></span>
<span><span class="co">#&gt; In FUN(X[[i]], ...) :</span></span>
<span><span class="co">#&gt;   Possible OpenBabel errors detected and only NAs returned.</span></span>
<span><span class="co">#&gt; Run with `validate = FALSE` to ignore this.</span></span></code></pre></div>
<p>Without validation, it will return an incorrect value for
<code>rvi</code> and <code>category</code> for this compound.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_vol.html">calc_vol</a></span><span class="op">(</span><span class="va">c00157</span>, validate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ==============================</span></span>
<span><span class="co">#&gt; *** Open Babel Warning  in InChI code</span></span>
<span><span class="co">#&gt;   Phosphatidylcholine :Unknown element(s): *</span></span>
<span><span class="co">#&gt; ==============================</span></span>
<span><span class="co">#&gt; *** Open Babel Error  in InChI code</span></span>
<span><span class="co">#&gt;   InChI generation failed</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span><span class="co">#&gt;   mol_path                                                          formula    name                 rvi category</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                             &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt; &lt;fct&gt;   </span></span>
<span><span class="co">#&gt; 1 /Users/ericscott/Documents/GitHub/volcalc/inst/extdata/C00157.mol C10H18NO8P Phosphatidylcholi…  2.89 high     </span></span></code></pre></div>
<p>Phosphatidylcholine is a large phospholipid and is
<strong>not</strong> highly volatile as these results would suggest.</p>
<div class="section level4">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h4>
<p>Unfortunately, it is nearly impossible to detect these parsing errors
from OpenBabel directly in R. When <code>validate = TRUE</code> is set
(which it is by default), <code><a href="../reference/calc_vol.html">calc_vol()</a></code> will look for
“symptoms” of OpenBabel errors and return <code>NA</code>s for all
values. Namely, validation works by assuming that InChI generation will
fail whenever there are OpenBabel parsing issues. Because InChI
generation is not available on the Windows version of OpenBabel
installed with <code>ChemmineOB</code>, this <code>volcalc</code>
feature is only available on macOS and Linux. Setting
<code>validate = TRUE</code> on Windows will have no effect.</p>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Donahue, N.M., Robinson, A.L., Stanier, C.O., Pandis, S.N., 2006.
Coupled Partitioning, Dilution, and Chemical Aging of Semivolatile
Organics. Environ. Sci. Technol. 40, 2635–2643. DOI:
10.1021/es052297c</p>
<p>Meredith L, Ledford S, Riemer K, Geffre P, Graves K, Honeker L,
LeBauer D, Tfaily M, Krechmer J, 2023. Automating methods for estimating
metabolite volatility. Frontiers in Microbiology. DOI:
10.3389/fmicb.2023.1267234</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristina Riemer, Eric R. Scott, Laura K. Meredith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
